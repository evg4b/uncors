name: "HTTP Status Codes"
description: "Test handling of various HTTP status codes"

backend:
  endpoints:
    - path: /api/success
      method: GET
      response:
        status: 200
        body: '{"status":"ok"}'

    - path: /api/created
      method: POST
      response:
        status: 201
        body: '{"status":"created"}'

    - path: /api/no-content
      method: DELETE
      response:
        status: 204

    - path: /api/redirect
      method: GET
      response:
        status: 302
        headers:
          Location: /api/success

    - path: /api/bad-request
      method: GET
      response:
        status: 400
        body: '{"error":"bad request"}'

    - path: /api/unauthorized
      method: GET
      response:
        status: 401
        body: '{"error":"unauthorized"}'

    - path: /api/forbidden
      method: GET
      response:
        status: 403
        body: '{"error":"forbidden"}'

    - path: /api/not-found
      method: GET
      response:
        status: 404
        body: '{"error":"not found"}'

    - path: /api/server-error
      method: GET
      response:
        status: 500
        body: '{"error":"internal server error"}'

uncors:
  http-port: 3004
  mappings:
    - from: http://test.local:3004
      to: "{{backend}}"

tests:
  - name: "200 OK"
    requests:
      - method: GET
        path: /api/success
        headers:
          User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
          Accept: application/json, text/plain, */*
          Accept-Encoding: gzip, deflate, br
          Accept-Language: en-US,en;q=0.9
          Connection: keep-alive
    expected:
      status: 200

  - name: "201 Created"
    requests:
      - method: POST
        path: /api/created
        headers:
          User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
          Accept: application/json
          Accept-Encoding: gzip, deflate, br
          Accept-Language: en-US,en;q=0.9
          Content-Type: application/json
          Connection: keep-alive
    expected:
      status: 201

  - name: "204 No Content"
    requests:
      - method: DELETE
        path: /api/no-content
        headers:
          User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/121.0
          Accept: "*/*"
          Accept-Encoding: gzip, deflate, br
          Accept-Language: en-US,en;q=0.9
          Connection: keep-alive
    expected:
      status: 204

  - name: "302 Redirect"
    requests:
      - method: GET
        path: /api/redirect
        headers:
          User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Mobile/15E148 Safari/604.1
          Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
          Accept-Encoding: gzip, deflate
          Accept-Language: en-US,en;q=0.9
          Connection: keep-alive
    expected:
      status: 302
      headers:
        Location: /api/success

  - name: "400 Bad Request"
    requests:
      - method: GET
        path: /api/bad-request
        headers:
          User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/121.0
          Accept: application/json
          Accept-Encoding: gzip, deflate, br
          Accept-Language: en-US,en;q=0.9
          Connection: keep-alive
    expected:
      status: 400
      body-contains:
        - "bad request"

  - name: "401 Unauthorized"
    requests:
      - method: GET
        path: /api/unauthorized
        headers:
          User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/605.1.15
          Accept: application/json
          Accept-Encoding: gzip, deflate
          Accept-Language: en-US,en;q=0.9
          Connection: keep-alive
    expected:
      status: 401
      body-contains:
        - "unauthorized"

  - name: "403 Forbidden"
    requests:
      - method: GET
        path: /api/forbidden
        headers:
          User-Agent: Mozilla/5.0 (iPad; CPU OS 17_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Mobile/15E148 Safari/604.1
          Accept: application/json
          Accept-Encoding: gzip, deflate
          Accept-Language: en-US,en;q=0.9
          Connection: keep-alive
    expected:
      status: 403
      body-contains:
        - "forbidden"

  - name: "404 Not Found"
    requests:
      - method: GET
        path: /api/not-found
        headers:
          User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/121.0
          Accept: application/json
          Accept-Encoding: gzip, deflate, br
          Accept-Language: en-US,en;q=0.9
          Connection: keep-alive
          DNT: "1"
    expected:
      status: 404
      body-contains:
        - "not found"

  - name: "500 Server Error"
    requests:
      - method: GET
        path: /api/server-error
        headers:
          User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0
          Accept: application/json
          Accept-Encoding: gzip, deflate, br
          Accept-Language: en-US,en;q=0.9
          Connection: keep-alive
    expected:
      status: 500
      body-contains:
        - "internal server error"
