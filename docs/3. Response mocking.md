# Response Mocking

The mocking system allows you to simulate API responses for specific endpoints during development and testing. Mock responses can be filtered by path, HTTP method, query parameters, and headers using the [gorilla/mux route matching system](https://github.com/gorilla/mux#matching-routes).

**Key features:**

- **Path-based matching**: Define which URLs to intercept
- **Method-specific**: Target specific HTTP methods (GET, POST, etc.)
- **Query parameter filtering**: Match requests with specific query strings
- **Header matching**: Filter by HTTP headers
- **Configurable responses**: Control status codes, headers, delays, and content

**Configuration structure:**

```yaml
mappings:
  - from: ...
    to: ...
    mocks:
      - path: /example-endpoint
        method: POST
        queries:
          param1: value1
          param2: value2
        headers:
          Content-Type: application/json
        response:
          code: 201
          headers:
            Content-Type: application/json
          delay: 10s
          raw: `{ "ok": true }`
          file: /path/to/file.json
```

# Request Matching

Configure which requests should be intercepted by the mock:

## Path (Required)

Defines the URL path to mock. Supports static paths and variable segments.

**Examples:**

```yaml
path: /api/users              # Static path
path: /users/{id}             # Variable segment
path: /posts/{postId}/comments/{commentId}  # Multiple variables
```

Variable segments (e.g., `{id}`) match any value in that position. A request to `/users/123` matches `/users/{id}`.

## Method (Optional)

Specifies the HTTP method to match.

| Property | Type   | Default | Description                                                |
| -------- | ------ | ------- | ---------------------------------------------------------- |
| `method` | string | Any     | HTTP method: `GET`, `POST`, `PUT`, `DELETE`, `PATCH`, etc. |

If omitted, the mock matches all HTTP methods.

## Query Parameters (Optional)

Match requests with specific query string parameters.

```yaml
queries:
  param1: value1
  param2: value2
```

If omitted, all query parameter combinations are matched.

## Headers (Optional)

Match requests with specific HTTP headers.

```yaml
headers:
  Content-Type: application/json
  Authorization: Bearer token123
```

If omitted, all header combinations are matched.

# Response Configuration

Define the response returned when a mock is triggered.

## Response Properties

| Property  | Type    | Required      | Default | Description                                |
| --------- | ------- | ------------- | ------- | ------------------------------------------ |
| `code`    | integer | No            | 200     | HTTP status code (e.g., 200, 404, 500)     |
| `headers` | object  | No            | -       | Custom HTTP headers to include in response |
| `delay`   | string  | No            | -       | Response delay (e.g., `1m 30s`, `500ms`)   |
| `raw`     | string  | Conditional\* | -       | Raw response content                       |
| `file`    | string  | Conditional\* | -       | Path to file containing response content   |

**\*One of `raw` or `file` must be specified.**

## Status Code

```yaml
response:
  code: 201
```

## Headers

Add or override response headers:

```yaml
response:
  headers:
    Content-Type: application/json
    X-Custom-Header: value
```

## Delay

Simulate network latency or slow endpoints. Format: `<number><unit> [<number><unit> ...]`

**Supported units:**

- `ns` - nanoseconds
- `us` or `Âµs` - microseconds
- `ms` - milliseconds
- `s` - seconds
- `m` - minutes
- `h` - hours

**Examples:**

```yaml
delay: 500ms          # Half a second
delay: 1m 30s         # 1 minute 30 seconds
delay: 2s 500ms       # 2.5 seconds
```

## Response Content

Choose one of two methods to provide response content:

### Raw Content

Inline text or JSON:

```yaml
response:
  raw: '{"message": "Success", "id": 123}'
```

### File Content

Load response from a file:

```yaml
response:
  file: ~/mocks/users-response.json
```

## Script Handler

For dynamic responses including fake data generation, use the Script Handler feature (see [Script Handler documentation](./9.-Script-Handler) for details).
